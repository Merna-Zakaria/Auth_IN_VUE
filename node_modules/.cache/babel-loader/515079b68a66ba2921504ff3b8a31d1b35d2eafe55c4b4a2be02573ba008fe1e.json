{"ast":null,"code":"import _slicedToArray from \"/home/merna-zakaria/projects/self-learning-projects/vue_register_project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regeneratorRuntime from \"/home/merna-zakaria/projects/self-learning-projects/vue_register_project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/merna-zakaria/projects/self-learning-projects/vue_register_project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _toConsumableArray from \"/home/merna-zakaria/projects/self-learning-projects/vue_register_project/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _objectSpread from \"/home/merna-zakaria/projects/self-learning-projects/vue_register_project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { mergeProps as _mergeProps, createVNode as _createVNode } from \"vue\";\n// Styles\nimport \"./VDialog.css\";\n\n// Components\nimport { VDialogTransition } from \"../transitions/index.mjs\";\nimport { VDefaultsProvider } from \"../VDefaultsProvider/index.mjs\";\nimport { VOverlay } from \"../VOverlay/index.mjs\"; // Composables\nimport { useProxiedModel } from \"../../composables/proxiedModel.mjs\";\nimport { useScopeId } from \"../../composables/scopeId.mjs\";\nimport { forwardRefs } from \"../../composables/forwardRefs.mjs\"; // Utilities\nimport { mergeProps, nextTick, ref, watch } from 'vue';\nimport { genericComponent, IN_BROWSER, useRender } from \"../../util/index.mjs\";\nimport { filterVOverlayProps, makeVOverlayProps } from \"../VOverlay/VOverlay.mjs\"; // Types\nexport var VDialog = genericComponent()({\n  name: 'VDialog',\n  props: _objectSpread({\n    fullscreen: Boolean,\n    retainFocus: {\n      type: Boolean,\n      \"default\": true\n    },\n    scrollable: Boolean\n  }, makeVOverlayProps({\n    origin: 'center center',\n    scrollStrategy: 'block',\n    transition: {\n      component: VDialogTransition\n    },\n    zIndex: 2400\n  })),\n  emits: {\n    'update:modelValue': function updateModelValue(value) {\n      return true;\n    }\n  },\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots;\n    var isActive = useProxiedModel(props, 'modelValue');\n    var _useScopeId = useScopeId(),\n      scopeId = _useScopeId.scopeId;\n    var overlay = ref();\n    function onFocusin(e) {\n      var _overlay$value, _overlay$value2;\n      var before = e.relatedTarget;\n      var after = e.target;\n      if (before !== after && (_overlay$value = overlay.value) != null && _overlay$value.contentEl &&\n      // We're the topmost dialog\n      (_overlay$value2 = overlay.value) != null && _overlay$value2.globalTop &&\n      // It isn't the document or the dialog body\n      ![document, overlay.value.contentEl].includes(after) &&\n      // It isn't inside the dialog body\n      !overlay.value.contentEl.contains(after)) {\n        var focusable = _toConsumableArray(overlay.value.contentEl.querySelectorAll('button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])')).filter(function (el) {\n          return !el.hasAttribute('disabled') && !el.matches('[tabindex=\"-1\"]');\n        });\n        if (!focusable.length) return;\n        var firstElement = focusable[0];\n        var lastElement = focusable[focusable.length - 1];\n        if (before === firstElement) {\n          lastElement.focus();\n        } else {\n          firstElement.focus();\n        }\n      }\n    }\n    if (IN_BROWSER) {\n      watch(function () {\n        return isActive.value && props.retainFocus;\n      }, function (val) {\n        val ? document.addEventListener('focusin', onFocusin) : document.removeEventListener('focusin', onFocusin);\n      }, {\n        immediate: true\n      });\n    }\n    watch(isActive, /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(val) {\n        var _contentEl, _activatorEl;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return nextTick();\n              case 2:\n                if (val) {\n                  (_contentEl = overlay.value.contentEl) == null ? void 0 : _contentEl.focus({\n                    preventScroll: true\n                  });\n                } else {\n                  (_activatorEl = overlay.value.activatorEl) == null ? void 0 : _activatorEl.focus({\n                    preventScroll: true\n                  });\n                }\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n    useRender(function () {\n      var _filterVOverlayProps = filterVOverlayProps(props),\n        _filterVOverlayProps2 = _slicedToArray(_filterVOverlayProps, 1),\n        overlayProps = _filterVOverlayProps2[0];\n      return _createVNode(VOverlay, _mergeProps({\n        \"ref\": overlay,\n        \"class\": ['v-dialog', {\n          'v-dialog--fullscreen': props.fullscreen,\n          'v-dialog--scrollable': props.scrollable\n        }]\n      }, overlayProps, {\n        \"modelValue\": isActive.value,\n        \"onUpdate:modelValue\": function onUpdateModelValue($event) {\n          return isActive.value = $event;\n        },\n        \"aria-role\": \"dialog\",\n        \"aria-modal\": \"true\",\n        \"activatorProps\": mergeProps({\n          'aria-haspopup': 'dialog',\n          'aria-expanded': String(isActive.value)\n        }, props.activatorProps)\n      }, scopeId), {\n        activator: slots.activator,\n        \"default\": function _default() {\n          var _slots$default;\n          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n          return _createVNode(VDefaultsProvider, {\n            \"root\": true\n          }, {\n            \"default\": function _default() {\n              var _slots$default2;\n              return [(_slots$default = slots[\"default\"]) == null ? void 0 : (_slots$default2 = _slots$default).call.apply(_slots$default2, [slots].concat(args))];\n            }\n          });\n        }\n      });\n    });\n    return forwardRefs({}, overlay);\n  }\n});","map":{"version":3,"mappings":"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","names":["VDialogTransition","VDefaultsProvider","VOverlay","useProxiedModel","useScopeId","forwardRefs","mergeProps","nextTick","ref","watch","genericComponent","IN_BROWSER","useRender","filterVOverlayProps","makeVOverlayProps","VDialog","name","props","fullscreen","Boolean","retainFocus","type","default","scrollable","origin","scrollStrategy","transition","component","zIndex","emits","value","setup","slots","_ref","isActive","scopeId","overlay","onFocusin","e","before","relatedTarget","after","target","_overlay$value","contentEl","_overlay$value2","globalTop","document","includes","contains","focusable","querySelectorAll","filter","el","hasAttribute","matches","length","firstElement","lastElement","focus","val","addEventListener","removeEventListener","immediate","_contentEl","preventScroll","activatorEl","_activatorEl","overlayProps","String","activatorProps","activator","args"],"sources":["../../../src/components/VDialog/VDialog.tsx"],"sourcesContent":["// Styles\nimport './VDialog.sass'\n\n// Components\nimport { VDialogTransition } from '@/components/transitions'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\nimport { VOverlay } from '@/components/VOverlay'\n\n// Composables\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { useScopeId } from '@/composables/scopeId'\nimport { forwardRefs } from '@/composables/forwardRefs'\n\n// Utilities\nimport { mergeProps, nextTick, ref, watch } from 'vue'\nimport { genericComponent, IN_BROWSER, useRender } from '@/util'\nimport { filterVOverlayProps, makeVOverlayProps } from '@/components/VOverlay/VOverlay'\n\n// Types\nimport type { SlotsToProps } from '@/util'\nimport type { OverlaySlots } from '@/components/VOverlay/VOverlay'\n\nexport const VDialog = genericComponent<new () => {\n  $props: SlotsToProps<OverlaySlots>\n}>()({\n  name: 'VDialog',\n\n  props: {\n    fullscreen: Boolean,\n    retainFocus: {\n      type: Boolean,\n      default: true,\n    },\n    scrollable: Boolean,\n\n    ...makeVOverlayProps({\n      origin: 'center center' as const,\n      scrollStrategy: 'block' as const,\n      transition: { component: VDialogTransition },\n      zIndex: 2400,\n    }),\n  },\n\n  emits: {\n    'update:modelValue': (value: boolean) => true,\n  },\n\n  setup (props, { slots }) {\n    const isActive = useProxiedModel(props, 'modelValue')\n    const { scopeId } = useScopeId()\n\n    const overlay = ref<VOverlay>()\n    function onFocusin (e: FocusEvent) {\n      const before = e.relatedTarget as HTMLElement | null\n      const after = e.target as HTMLElement | null\n\n      if (\n        before !== after &&\n        overlay.value?.contentEl &&\n        // We're the topmost dialog\n        overlay.value?.globalTop &&\n        // It isn't the document or the dialog body\n        ![document, overlay.value.contentEl].includes(after!) &&\n        // It isn't inside the dialog body\n        !overlay.value.contentEl.contains(after)\n      ) {\n        const focusable = [...overlay.value.contentEl.querySelectorAll(\n          'button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n        )].filter(el => !el.hasAttribute('disabled') && !el.matches('[tabindex=\"-1\"]')) as HTMLElement[]\n\n        if (!focusable.length) return\n\n        const firstElement = focusable[0]\n        const lastElement = focusable[focusable.length - 1]\n\n        if (before === firstElement) {\n          lastElement.focus()\n        } else {\n          firstElement.focus()\n        }\n      }\n    }\n\n    if (IN_BROWSER) {\n      watch(() => isActive.value && props.retainFocus, val => {\n        val\n          ? document.addEventListener('focusin', onFocusin)\n          : document.removeEventListener('focusin', onFocusin)\n      }, { immediate: true })\n    }\n\n    watch(isActive, async val => {\n      await nextTick()\n      if (val) {\n        overlay.value!.contentEl?.focus({ preventScroll: true })\n      } else {\n        overlay.value!.activatorEl?.focus({ preventScroll: true })\n      }\n    })\n\n    useRender(() => {\n      const [overlayProps] = filterVOverlayProps(props)\n\n      return (\n        <VOverlay\n          ref={ overlay }\n          class={[\n            'v-dialog',\n            {\n              'v-dialog--fullscreen': props.fullscreen,\n              'v-dialog--scrollable': props.scrollable,\n            },\n          ]}\n          { ...overlayProps }\n          v-model={ isActive.value }\n          aria-role=\"dialog\"\n          aria-modal=\"true\"\n          activatorProps={ mergeProps({\n            'aria-haspopup': 'dialog',\n            'aria-expanded': String(isActive.value),\n          }, props.activatorProps) }\n          { ...scopeId }\n        >\n          {{\n            activator: slots.activator,\n            default: (...args) => (\n              <VDefaultsProvider root>\n                { slots.default?.(...args) }\n              </VDefaultsProvider>\n            ),\n          }}\n        </VOverlay>\n      )\n    })\n\n    return forwardRefs({}, overlay)\n  },\n})\n\nexport type VDialog = InstanceType<typeof VDialog>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}